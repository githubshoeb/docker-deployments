<IfModule mod_rewrite.c>
    RewriteEngine On

    # Ensure HTTPS is detected if behind a reverse proxy or load balancer
    RewriteCond %{HTTP:X-Forwarded-Proto} =https
    RewriteRule ^ - [E=HTTPS:on]

    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
    RewriteBase /

    # If the request is for index.php, just serve it
    RewriteRule ^index\.php$ - [L]

    # If the request is not for a valid file or directory, route it to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
</IfModule>
